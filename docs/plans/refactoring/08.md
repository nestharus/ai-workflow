I have created the following plan after thorough exploration and analysis of the codebase. Follow the below plan verbatim. Trust the files and references. Do not re-verify what's written in the plan. Explore only when absolutely necessary. First implement all the proposed file changes and then I'll review all the changes together at the end.

### Observations

The current codebase has a solid foundation with modern FastAPI and Pydantic v2 patterns, including lifespan management in `app/core/factory.py`, async connection pooling in `app/infrastructure/db_connections.py`, and proper test fixtures in `tests/conftest.py`. However, there's no centralized documentation of these patterns, and some areas need alignment with 2024-2025 best practices:

**Current Strengths:**
- Pydantic v2 with `ConfigDict(extra="forbid")` in contracts
- Async connection pooling for SurrealDB and Elasticsearch
- Lifespan management with proper startup/shutdown
- ORJSONResponse for performance
- Structured test fixtures with integration and E2E separation

**Gaps Identified:**
- No unified error handling with `AppError`/`DomainError` pattern
- No generic `Paginated[T]` model for consistent pagination
- Dependency injection scattered across files (inline in routers)
- No repository pattern documentation or implementation
- Testing uses monkeypatch instead of `dependency_overrides`
- No middleware stack documentation (security headers, compression)
- Missing comprehensive pattern documentation

**Research Findings:**
From FastAPI docs and 2024 best practices, the following patterns should be documented:
1. Centralized dependency injection with `Annotated` type aliases
2. Unified error handling with custom exception handlers
3. Repository pattern for data access abstraction
4. Middleware ordering (TrustedHost → Security → GZip)
5. Testing with `app.dependency_overrides` instead of monkeypatch
6. Generic Pydantic models for pagination
7. Service layer that raises domain exceptions

### Approach

Create 1 comprehensive Markdown documentation file in `docs/` that establish patterns for the entire FastAPI application architecture. Each file will:

1. Define the pattern with clear rationale
2. Provide code examples from the existing codebase where applicable
3. Include 2024-2025 best practices from FastAPI and Pydantic v2
4. Reference related patterns in other documentation files
5. Include anti-patterns to avoid

The documentation will serve as the single source of truth for development patterns, ensuring consistency across the codebase and enabling future refactoring phases to align with these standards.

### Reasoning

I explored the current codebase structure by reading key files including `app/core/factory.py`, `app/infrastructure/db_connections.py`, `tests/conftest.py`, and various contracts, services, and routers. I then used context7 to resolve FastAPI and Pydantic library documentation, firecrawl to scrape official FastAPI documentation on dependencies, error handling, middleware, and bigger applications, and web search to find 2024 best practices for repository patterns, connection pooling, and testing with dependency_overrides. This comprehensive research provided the foundation for creating detailed pattern documentation.

## Proposed File Change

### docs\settings-patterns.md(NEW)

References:

- app\core\settings.py
- app\core\dependencies.py
- tests\conftest.py
- tests\unit\test_validation_errors.py

Create settings patterns documentation covering:

**1. Pydantic Settings Best Practices**
- Current implementation in `app/core/settings.py` is excellent
- Use `pydantic-settings` `BaseSettings` class (line 75)
- All settings loaded from environment variables
- Type validation and conversion automatic

**2. Settings Structure**
- Group related settings (app, database, search, etc.)
- Use descriptive names: `surrealdb_url`, not `db_url`
- Provide sensible defaults for development
- Mark secrets with `repr=False` and `json_schema_extra={"format": "password"}` (lines 93-94)

**3. Field Validation**
- Use `@field_validator` for custom validation (reference lines 112-147)
- Example: URL scheme validation for `surrealdb_url` (lines 112-118)
- Example: Positive integer validation (lines 128-140)
- Create custom exception classes for validation errors (lines 43-73)

**4. Credential Security**
- Use complex password pattern for credentials (lines 13-40)
- Minimum length requirements (line 91: `min_length=12`)
- Pattern validation for complexity (uppercase, lowercase, digit, special char)
- Never log or expose credentials (use `repr=False`)

**5. Environment-Specific Configuration**
- Use `.env` files for local development
- Use environment variables in production (container orchestration)
- Support multiple environments: development, staging, production
- Use `debug` flag for environment-specific behavior (line 83)

**6. Settings Dependency Injection**
- Provide settings via dependency (reference `app/core/dependencies.py` lines 8-11)
- Use `@lru_cache` for singleton pattern (line 8)
- Inject into routes/services that need configuration
- Override in tests using `app.dependency_overrides`

**7. Settings Testing**
- Create test settings with safe defaults (reference `tests/conftest.py` lines 74-83)
- Override specific fields for test scenarios (line 103)
- Use `model_copy(update={...})` for test variations (line 103)
- Generate test credentials that pass validation (lines 42-43)

**8. Database Connection Settings**
- Current implementation covers SurrealDB and Elasticsearch well
- Include connection pool settings (line 103: `surrealdb_pool_size`)
- Include timeout settings (line 107: `elasticsearch_request_timeout`)
- Include replica/shard settings for search (lines 108-109)

**9. Feature Flags**
- Use boolean settings for feature toggles (line 84: `include_error_body`)
- Document feature flags clearly
- Consider using separate feature flag service for complex scenarios
- Example: `enable_gzip`, `enforce_https` (to be added)

**10. Settings Documentation**
- Document all settings in docstrings
- Include default values and valid ranges
- Document environment variable names
- Example: `SURREALDB_URL`, `SURREALDB_USER`, etc.

**11. Anti-Patterns to Avoid**
- Hardcoding configuration values in code
- Using global variables instead of Settings class
- Not validating settings at startup
- Exposing secrets in logs or error messages
- Using different settings patterns across the codebase